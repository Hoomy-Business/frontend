import{b as N,j as e}from"./query-vendor-yCE0qXS-.js";import{u as w,r as c,L as m}from"./react-vendor-CvpuY9Ms.js";import{u as v,F as y,a as u,b as x,c as h,d as f,e as p,t as C,l as E}from"./schema-Beqd3mZa.js";import{L}from"./Logo-6y9ImIyh.js";import{a as F,C as S,d as A,e as P,f as k,b as I,g as D,B as M,c as T}from"./index-iWuRHTV7.js";import{I as j}from"./input-DjOsQyli.js";import{A as B,a as O}from"./alert-D3SZgpCp.js";import{M as R}from"./mail-BibQkIwU.js";import{L as _}from"./lock-De7yFJBd.js";import"./ui-vendor-3oCJfrha.js";import"./label-D0E_E_5t.js";function Y(){w();const{login:g,isAuthenticated:n,user:t}=F(),[l,a]=c.useState("");c.useEffect(()=>{if(n&&t){let s="/dashboard/owner";t.role==="admin"?s="/admin/dashboard":t.role==="student"&&(s="/dashboard/student"),window.location.href=s}},[n,t]);const r=v({resolver:C(E),defaultValues:{email:"",password:""}}),i=N({mutationFn:s=>T("POST","/login",s),onSuccess:s=>{g(s.token,s.user);const d=s.user.role;let o="/dashboard/owner";d==="admin"?o="/admin/dashboard":d==="student"&&(o="/dashboard/student"),window.location.href=o},onError:s=>{s.message.includes("EMAIL_NOT_VERIFIED")?a("Please verify your email before logging in. Check your inbox for the verification code."):s.message.includes("ACCOUNT_DELETED")?a("This account has been deleted."):a(s.message||"Login failed. Please check your credentials.")}}),b=s=>{a(""),i.mutate(s)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-muted/30 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(m,{href:"/",children:e.jsx("div",{className:"mb-4 cursor-pointer",children:e.jsx(L,{iconClassName:"h-8 w-8",textClassName:"text-2xl"})})}),e.jsx("h1",{className:"text-3xl font-bold","data-testid":"text-login-title",children:"Welcome Back"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Sign in to your account to continue"})]}),e.jsxs(S,{children:[e.jsxs(A,{children:[e.jsx(P,{children:"Login"}),e.jsx(k,{children:"Enter your email and password to access your account"})]}),e.jsxs(I,{children:[l&&e.jsxs(B,{variant:"destructive",className:"mb-4",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx(O,{children:l})]}),e.jsx(y,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(b),className:"space-y-4",children:[e.jsx(u,{control:r.control,name:"email",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Email"}),e.jsx(f,{children:e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{...s,type:"email",placeholder:"your.email@example.com",className:"pl-10","data-testid":"input-email"})]})}),e.jsx(p,{})]})}),e.jsx(u,{control:r.control,name:"password",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Password"}),e.jsx(f,{children:e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{...s,type:"password",placeholder:"••••••••",className:"pl-10","data-testid":"input-password"})]})}),e.jsx(p,{})]})}),e.jsx(M,{type:"submit",className:"w-full",size:"lg",disabled:i.isPending,"data-testid":"button-submit",children:i.isPending?"Signing in...":"Sign In"})]})}),e.jsx("div",{className:"mt-6 text-center text-sm",children:e.jsxs("p",{className:"text-muted-foreground",children:["Don't have an account?"," ",e.jsx(m,{href:"/register",className:"text-primary font-medium hover:underline","data-testid":"link-register",children:"Sign up"})]})})]})]})]})})}export{Y as default};
