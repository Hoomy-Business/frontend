import{j as e,b as pe}from"./query-vendor-yCE0qXS-.js";import{r as n,u as me,f as fe,L as q}from"./react-vendor-CvpuY9Ms.js";import{u as he,F as xe,a as g,b as C,c as y,d as N,e as k,f as je,t as ve,r as be}from"./schema-Beqd3mZa.js";import{L as ge}from"./Logo-6y9ImIyh.js";import{i as _,a as Ce,C as ye,d as Ne,e as ke,f as Re,b as we,g as Pe,B as Ee,c as Se}from"./index-iWuRHTV7.js";import{I as P}from"./input-DjOsQyli.js";import{n as F,q as L,l as I,r as S,s as T,I as B,J as K,K as $,L as Ie,B as U,M as _e,N as Ae}from"./ui-vendor-3oCJfrha.js";import{a as De,C as Fe,U as Le}from"./user-CTEB5HWp.js";import{A as Ge,a as Me}from"./alert-D3SZgpCp.js";import{M as Oe}from"./mail-BibQkIwU.js";import{L as qe}from"./lock-De7yFJBd.js";import{P as Te}from"./phone-C3Uyl9SW.js";import{C as Be}from"./calendar-DFxuDeKa.js";import"./label-D0E_E_5t.js";var G="Radio",[Ke,V]=F(G),[$e,Ue]=Ke(G),H=n.forwardRef((s,d)=>{const{__scopeRadio:r,name:i,checked:o=!1,required:a,disabled:l,value:u="on",onCheck:f,form:h,...c}=s,[m,p]=n.useState(null),t=L(d,b=>p(b)),x=n.useRef(!1),v=m?h||!!m.closest("form"):!0;return e.jsxs($e,{scope:r,checked:o,disabled:l,children:[e.jsx(I.button,{type:"button",role:"radio","aria-checked":o,"data-state":X(o),"data-disabled":l?"":void 0,disabled:l,value:u,...c,ref:t,onClick:S(s.onClick,b=>{o||f==null||f(),v&&(x.current=b.isPropagationStopped(),x.current||b.stopPropagation())})}),v&&e.jsx(Ve,{control:m,bubbles:!x.current,name:i,value:u,checked:o,required:a,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});H.displayName=G;var z="RadioIndicator",J=n.forwardRef((s,d)=>{const{__scopeRadio:r,forceMount:i,...o}=s,a=Ue(z,r);return e.jsx(T,{present:i||a.checked,children:e.jsx(I.span,{"data-state":X(a.checked),"data-disabled":a.disabled?"":void 0,...o,ref:d})})});J.displayName=z;var Ve=s=>{const{control:d,checked:r,bubbles:i=!0,...o}=s,a=n.useRef(null),l=B(r),u=K(d);return n.useEffect(()=>{const f=a.current,h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==r&&m){const p=new Event("click",{bubbles:i});m.call(f,r),f.dispatchEvent(p)}},[l,r,i]),e.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:r,...o,tabIndex:-1,ref:a,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function X(s){return s?"checked":"unchecked"}var He=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],M="RadioGroup",[ze,jt]=F(M,[$,V]),Y=$(),W=V(),[Je,Xe]=ze(M),Q=n.forwardRef((s,d)=>{const{__scopeRadioGroup:r,name:i,defaultValue:o,value:a,required:l=!1,disabled:u=!1,orientation:f,dir:h,loop:c=!0,onValueChange:m,...p}=s,t=Y(r),x=Ie(h),[v,b]=U({prop:a,defaultProp:o,onChange:m});return e.jsx(Je,{scope:r,name:i,required:l,disabled:u,value:v,onValueChange:b,children:e.jsx(_e,{asChild:!0,...t,orientation:f,dir:x,loop:c,children:e.jsx(I.div,{role:"radiogroup","aria-required":l,"aria-orientation":f,"data-disabled":u?"":void 0,dir:x,...p,ref:d})})})});Q.displayName=M;var Z="RadioGroupItem",ee=n.forwardRef((s,d)=>{const{__scopeRadioGroup:r,disabled:i,...o}=s,a=Xe(Z,r),l=a.disabled||i,u=Y(r),f=W(r),h=n.useRef(null),c=L(d,h),m=a.value===o.value,p=n.useRef(!1);return n.useEffect(()=>{const t=v=>{He.includes(v.key)&&(p.current=!0)},x=()=>p.current=!1;return document.addEventListener("keydown",t),document.addEventListener("keyup",x),()=>{document.removeEventListener("keydown",t),document.removeEventListener("keyup",x)}},[]),e.jsx(Ae,{asChild:!0,...u,focusable:!l,active:m,children:e.jsx(H,{disabled:l,required:a.required,checked:m,...f,...o,name:a.name,ref:c,onCheck:()=>a.onValueChange(o.value),onKeyDown:S(t=>{t.key==="Enter"&&t.preventDefault()}),onFocus:S(o.onFocus,()=>{var t;p.current&&((t=h.current)==null||t.click())})})})});ee.displayName=Z;var Ye="RadioGroupIndicator",te=n.forwardRef((s,d)=>{const{__scopeRadioGroup:r,...i}=s,o=W(r);return e.jsx(J,{...o,...i,ref:d})});te.displayName=Ye;var se=Q,re=ee,We=te;const ae=n.forwardRef(({className:s,...d},r)=>e.jsx(se,{className:_("grid gap-2",s),...d,ref:r}));ae.displayName=se.displayName;const D=n.forwardRef(({className:s,...d},r)=>e.jsx(re,{ref:r,className:_("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...d,children:e.jsx(We,{className:"flex items-center justify-center",children:e.jsx(De,{className:"h-2.5 w-2.5 fill-current text-current"})})}));D.displayName=re.displayName;var O="Checkbox",[Qe,vt]=F(O),[Ze,et]=Qe(O),oe=n.forwardRef((s,d)=>{const{__scopeCheckbox:r,name:i,checked:o,defaultChecked:a,required:l,disabled:u,value:f="on",onCheckedChange:h,form:c,...m}=s,[p,t]=n.useState(null),x=L(d,j=>t(j)),v=n.useRef(!1),b=p?c||!!p.closest("form"):!0,[w=!1,A]=U({prop:o,defaultProp:a,onChange:h}),ue=n.useRef(w);return n.useEffect(()=>{const j=p==null?void 0:p.form;if(j){const E=()=>A(ue.current);return j.addEventListener("reset",E),()=>j.removeEventListener("reset",E)}},[p,A]),e.jsxs(Ze,{scope:r,state:w,disabled:u,children:[e.jsx(I.button,{type:"button",role:"checkbox","aria-checked":R(w)?"mixed":w,"aria-required":l,"data-state":ce(w),"data-disabled":u?"":void 0,disabled:u,value:f,...m,ref:x,onKeyDown:S(s.onKeyDown,j=>{j.key==="Enter"&&j.preventDefault()}),onClick:S(s.onClick,j=>{A(E=>R(E)?!0:!E),b&&(v.current=j.isPropagationStopped(),v.current||j.stopPropagation())})}),b&&e.jsx(tt,{control:p,bubbles:!v.current,name:i,value:f,checked:w,required:l,disabled:u,form:c,style:{transform:"translateX(-100%)"},defaultChecked:R(a)?!1:a})]})});oe.displayName=O;var ne="CheckboxIndicator",ie=n.forwardRef((s,d)=>{const{__scopeCheckbox:r,forceMount:i,...o}=s,a=et(ne,r);return e.jsx(T,{present:i||R(a.state)||a.state===!0,children:e.jsx(I.span,{"data-state":ce(a.state),"data-disabled":a.disabled?"":void 0,...o,ref:d,style:{pointerEvents:"none",...s.style}})})});ie.displayName=ne;var tt=s=>{const{control:d,checked:r,bubbles:i=!0,defaultChecked:o,...a}=s,l=n.useRef(null),u=B(r),f=K(d);n.useEffect(()=>{const c=l.current,m=window.HTMLInputElement.prototype,t=Object.getOwnPropertyDescriptor(m,"checked").set;if(u!==r&&t){const x=new Event("click",{bubbles:i});c.indeterminate=R(r),t.call(c,R(r)?!1:r),c.dispatchEvent(x)}},[u,r,i]);const h=n.useRef(R(r)?!1:r);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:o??h.current,...a,tabIndex:-1,ref:l,style:{...s.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function R(s){return s==="indeterminate"}function ce(s){return R(s)?"indeterminate":s?"checked":"unchecked"}var de=oe,st=ie;const le=n.forwardRef(({className:s,...d},r)=>e.jsx(de,{ref:r,className:_("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...d,children:e.jsx(st,{className:_("flex items-center justify-center text-current"),children:e.jsx(Fe,{className:"h-4 w-4"})})}));le.displayName=de.displayName;function bt(){const[,s]=me(),d=fe(),i=new URLSearchParams(d).get("role"),{isAuthenticated:o,user:a}=Ce(),[l,u]=n.useState(""),f=t=>{t.preventDefault(),t.stopPropagation(),s("/cgu")},h=t=>{t.preventDefault(),t.stopPropagation(),s("/privacy")};if(n.useEffect(()=>{o&&a&&(a.role==="admin"?s("/admin/dashboard"):a.role==="student"?s("/dashboard/student"):s("/dashboard/owner"))},[o,a,s]),o&&a)return null;const c=he({resolver:ve(be),defaultValues:{email:"",password:"",first_name:"",last_name:"",role:i==="owner"?"owner":"student",phone:"",date_of_birth:"",terms_accepted:!1}});n.useEffect(()=>{i&&(i==="student"||i==="owner")&&c.setValue("role",i)},[i,c]);const m=pe({mutationFn:t=>Se("POST","/auth/register",t),onSuccess:(t,x)=>{s(`/verify-email?email=${encodeURIComponent(x.email)}`)},onError:t=>{u(t.message||"Registration failed. Please try again.")}}),p=t=>{u(""),m.mutate(t)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-muted/30 p-4",children:e.jsxs("div",{className:"w-full max-w-2xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(q,{href:"/",children:e.jsx("div",{className:"mb-4 cursor-pointer",children:e.jsx(ge,{iconClassName:"h-8 w-8",textClassName:"text-2xl"})})}),e.jsx("h1",{className:"text-3xl font-bold","data-testid":"text-register-title",children:"Create Your Account"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Join thousands of students and landlords on Hoomy"})]}),e.jsxs(ye,{children:[e.jsxs(Ne,{children:[e.jsx(ke,{children:"Sign Up"}),e.jsx(Re,{children:"Fill in your details to create your account"})]}),e.jsxs(we,{children:[l&&e.jsxs(Ge,{variant:"destructive",className:"mb-4",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx(Me,{children:l})]}),e.jsx(xe,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(p),className:"space-y-4",children:[e.jsx(g,{control:c.control,name:"role",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"I am a"}),e.jsx(N,{children:e.jsxs(ae,{onValueChange:t.onChange,value:t.value,className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{value:"student",id:"student","data-testid":"radio-student"}),e.jsx("label",{htmlFor:"student",className:"cursor-pointer",children:"Student looking for housing"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{value:"owner",id:"owner","data-testid":"radio-owner"}),e.jsx("label",{htmlFor:"owner",className:"cursor-pointer",children:"Landlord with properties"})]})]})}),e.jsx(k,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(g,{control:c.control,name:"first_name",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"First Name"}),e.jsx(N,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Le,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{...t,placeholder:"John",className:"pl-10","data-testid":"input-firstname"})]})}),e.jsx(k,{})]})}),e.jsx(g,{control:c.control,name:"last_name",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"Last Name"}),e.jsx(N,{children:e.jsx(P,{...t,placeholder:"Doe","data-testid":"input-lastname"})}),e.jsx(k,{})]})})]}),e.jsx(g,{control:c.control,name:"email",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"Email"}),e.jsx(N,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{...t,type:"email",placeholder:"your.email@example.com",className:"pl-10","data-testid":"input-email"})]})}),e.jsx(k,{})]})}),e.jsx(g,{control:c.control,name:"password",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"Password"}),e.jsx(N,{children:e.jsxs("div",{className:"relative",children:[e.jsx(qe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{...t,type:"password",placeholder:"••••••••",className:"pl-10","data-testid":"input-password"})]})}),e.jsx(je,{children:"At least 8 characters"}),e.jsx(k,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(g,{control:c.control,name:"phone",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"Phone (Optional)"}),e.jsx(N,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{...t,placeholder:"+41 76 123 45 67",className:"pl-10","data-testid":"input-phone"})]})}),e.jsx(k,{})]})}),e.jsx(g,{control:c.control,name:"date_of_birth",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"Date of Birth"}),e.jsx(N,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{...t,type:"date",className:"pl-10","data-testid":"input-dob"})]})}),e.jsx(k,{})]})})]}),e.jsx(g,{control:c.control,name:"terms_accepted",render:({field:t})=>e.jsxs(C,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(N,{children:e.jsx(le,{checked:t.value,onCheckedChange:t.onChange,"data-testid":"checkbox-terms"})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(y,{children:["I accept the"," ",e.jsx("a",{href:"/cgu",className:"text-primary hover:underline",onClick:f,children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:"/privacy",className:"text-primary hover:underline",onClick:h,children:"Privacy Policy"})]}),e.jsx(k,{})]})]})}),e.jsx(Ee,{type:"submit",className:"w-full",size:"lg",disabled:m.isPending,"data-testid":"button-submit",children:m.isPending?"Creating account...":"Create Account"})]})}),e.jsx("div",{className:"mt-6 text-center text-sm",children:e.jsxs("p",{className:"text-muted-foreground",children:["Already have an account?"," ",e.jsx(q,{href:"/login",className:"text-primary font-medium hover:underline","data-testid":"link-login",children:"Sign in"})]})})]})]})]})})}export{bt as default};
