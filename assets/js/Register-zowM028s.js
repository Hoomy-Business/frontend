import{j as e,b as me}from"./query-vendor-CNIykozp.js";import{r as n,u as pe,f as fe,L as T}from"./react-vendor-DdYNpgPf.js";import{u as he,F as xe,a as g,b as C,c as y,d as k,e as N,f as je,t as ve,r as be}from"./schema-Dj5CwbO7.js";import{L as ge}from"./Logo-DzEVBPy7.js";import{B as Ce}from"./button-B-ZelJyK.js";import{I as P}from"./input-CHDUk6Su.js";import{C as ye,b as ke,c as Ne,d as Re,a as we}from"./card-ChNshBDf.js";import{e as F,u as L,f as I,g as S,h as q,i as $,j as B,k as K,l as Pe,m as U,n as Ee,I as Se}from"./ui-vendor-BME24-VV.js";import{c as _,a as Ie,b as _e}from"./index-BSTG6X_D.js";import{C as Ae,a as De,U as Fe}from"./user-CmdIW5DY.js";import{A as Le,a as Ge}from"./alert-OxPXOA7-.js";import{C as Me}from"./circle-alert-8bZ1axar.js";import{M as Oe}from"./mail-C3nBzua8.js";import{L as Te}from"./lock-BTNkw5Jz.js";import{P as qe}from"./phone-B8hTatBU.js";import{C as $e}from"./calendar-c1aj9U6M.js";import"./label-U3gdjbGY.js";var G="Radio",[Be,V]=F(G),[Ke,Ue]=Be(G),H=n.forwardRef((r,d)=>{const{__scopeRadio:s,name:i,checked:o=!1,required:a,disabled:l,value:u="on",onCheck:f,form:h,...c}=r,[p,m]=n.useState(null),t=L(d,b=>m(b)),x=n.useRef(!1),v=p?h||!!p.closest("form"):!0;return e.jsxs(Ke,{scope:s,checked:o,disabled:l,children:[e.jsx(I.button,{type:"button",role:"radio","aria-checked":o,"data-state":J(o),"data-disabled":l?"":void 0,disabled:l,value:u,...c,ref:t,onClick:S(r.onClick,b=>{o||f==null||f(),v&&(x.current=b.isPropagationStopped(),x.current||b.stopPropagation())})}),v&&e.jsx(Ve,{control:p,bubbles:!x.current,name:i,value:u,checked:o,required:a,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});H.displayName=G;var z="RadioIndicator",X=n.forwardRef((r,d)=>{const{__scopeRadio:s,forceMount:i,...o}=r,a=Ue(z,s);return e.jsx(q,{present:i||a.checked,children:e.jsx(I.span,{"data-state":J(a.checked),"data-disabled":a.disabled?"":void 0,...o,ref:d})})});X.displayName=z;var Ve=r=>{const{control:d,checked:s,bubbles:i=!0,...o}=r,a=n.useRef(null),l=$(s),u=B(d);return n.useEffect(()=>{const f=a.current,h=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==s&&p){const m=new Event("click",{bubbles:i});p.call(f,s),f.dispatchEvent(m)}},[l,s,i]),e.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:s,...o,tabIndex:-1,ref:a,style:{...r.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function J(r){return r?"checked":"unchecked"}var He=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],M="RadioGroup",[ze,gt]=F(M,[K,V]),Y=K(),W=V(),[Xe,Je]=ze(M),Q=n.forwardRef((r,d)=>{const{__scopeRadioGroup:s,name:i,defaultValue:o,value:a,required:l=!1,disabled:u=!1,orientation:f,dir:h,loop:c=!0,onValueChange:p,...m}=r,t=Y(s),x=Pe(h),[v,b]=U({prop:a,defaultProp:o,onChange:p});return e.jsx(Xe,{scope:s,name:i,required:l,disabled:u,value:v,onValueChange:b,children:e.jsx(Ee,{asChild:!0,...t,orientation:f,dir:x,loop:c,children:e.jsx(I.div,{role:"radiogroup","aria-required":l,"aria-orientation":f,"data-disabled":u?"":void 0,dir:x,...m,ref:d})})})});Q.displayName=M;var Z="RadioGroupItem",ee=n.forwardRef((r,d)=>{const{__scopeRadioGroup:s,disabled:i,...o}=r,a=Je(Z,s),l=a.disabled||i,u=Y(s),f=W(s),h=n.useRef(null),c=L(d,h),p=a.value===o.value,m=n.useRef(!1);return n.useEffect(()=>{const t=v=>{He.includes(v.key)&&(m.current=!0)},x=()=>m.current=!1;return document.addEventListener("keydown",t),document.addEventListener("keyup",x),()=>{document.removeEventListener("keydown",t),document.removeEventListener("keyup",x)}},[]),e.jsx(Se,{asChild:!0,...u,focusable:!l,active:p,children:e.jsx(H,{disabled:l,required:a.required,checked:p,...f,...o,name:a.name,ref:c,onCheck:()=>a.onValueChange(o.value),onKeyDown:S(t=>{t.key==="Enter"&&t.preventDefault()}),onFocus:S(o.onFocus,()=>{var t;m.current&&((t=h.current)==null||t.click())})})})});ee.displayName=Z;var Ye="RadioGroupIndicator",te=n.forwardRef((r,d)=>{const{__scopeRadioGroup:s,...i}=r,o=W(s);return e.jsx(X,{...o,...i,ref:d})});te.displayName=Ye;var re=Q,se=ee,We=te;const ae=n.forwardRef(({className:r,...d},s)=>e.jsx(re,{className:_("grid gap-2",r),...d,ref:s}));ae.displayName=re.displayName;const D=n.forwardRef(({className:r,...d},s)=>e.jsx(se,{ref:s,className:_("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...d,children:e.jsx(We,{className:"flex items-center justify-center",children:e.jsx(Ae,{className:"h-2.5 w-2.5 fill-current text-current"})})}));D.displayName=se.displayName;var O="Checkbox",[Qe,Ct]=F(O),[Ze,et]=Qe(O),oe=n.forwardRef((r,d)=>{const{__scopeCheckbox:s,name:i,checked:o,defaultChecked:a,required:l,disabled:u,value:f="on",onCheckedChange:h,form:c,...p}=r,[m,t]=n.useState(null),x=L(d,j=>t(j)),v=n.useRef(!1),b=m?c||!!m.closest("form"):!0,[w=!1,A]=U({prop:o,defaultProp:a,onChange:h}),ue=n.useRef(w);return n.useEffect(()=>{const j=m==null?void 0:m.form;if(j){const E=()=>A(ue.current);return j.addEventListener("reset",E),()=>j.removeEventListener("reset",E)}},[m,A]),e.jsxs(Ze,{scope:s,state:w,disabled:u,children:[e.jsx(I.button,{type:"button",role:"checkbox","aria-checked":R(w)?"mixed":w,"aria-required":l,"data-state":ce(w),"data-disabled":u?"":void 0,disabled:u,value:f,...p,ref:x,onKeyDown:S(r.onKeyDown,j=>{j.key==="Enter"&&j.preventDefault()}),onClick:S(r.onClick,j=>{A(E=>R(E)?!0:!E),b&&(v.current=j.isPropagationStopped(),v.current||j.stopPropagation())})}),b&&e.jsx(tt,{control:m,bubbles:!v.current,name:i,value:f,checked:w,required:l,disabled:u,form:c,style:{transform:"translateX(-100%)"},defaultChecked:R(a)?!1:a})]})});oe.displayName=O;var ne="CheckboxIndicator",ie=n.forwardRef((r,d)=>{const{__scopeCheckbox:s,forceMount:i,...o}=r,a=et(ne,s);return e.jsx(q,{present:i||R(a.state)||a.state===!0,children:e.jsx(I.span,{"data-state":ce(a.state),"data-disabled":a.disabled?"":void 0,...o,ref:d,style:{pointerEvents:"none",...r.style}})})});ie.displayName=ne;var tt=r=>{const{control:d,checked:s,bubbles:i=!0,defaultChecked:o,...a}=r,l=n.useRef(null),u=$(s),f=B(d);n.useEffect(()=>{const c=l.current,p=window.HTMLInputElement.prototype,t=Object.getOwnPropertyDescriptor(p,"checked").set;if(u!==s&&t){const x=new Event("click",{bubbles:i});c.indeterminate=R(s),t.call(c,R(s)?!1:s),c.dispatchEvent(x)}},[u,s,i]);const h=n.useRef(R(s)?!1:s);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:o??h.current,...a,tabIndex:-1,ref:l,style:{...r.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function R(r){return r==="indeterminate"}function ce(r){return R(r)?"indeterminate":r?"checked":"unchecked"}var de=oe,rt=ie;const le=n.forwardRef(({className:r,...d},s)=>e.jsx(de,{ref:s,className:_("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...d,children:e.jsx(rt,{className:_("flex items-center justify-center text-current"),children:e.jsx(De,{className:"h-4 w-4"})})}));le.displayName=de.displayName;function yt(){const[,r]=pe(),d=fe(),i=new URLSearchParams(d).get("role"),{isAuthenticated:o,user:a}=Ie(),[l,u]=n.useState(""),f=t=>{t.preventDefault(),t.stopPropagation(),r("/cgu")},h=t=>{t.preventDefault(),t.stopPropagation(),r("/privacy")};if(n.useEffect(()=>{o&&a&&(a.role==="admin"?r("/admin/dashboard"):a.role==="student"?r("/dashboard/student"):r("/dashboard/owner"))},[o,a,r]),o&&a)return null;const c=he({resolver:ve(be),defaultValues:{email:"",password:"",first_name:"",last_name:"",role:i==="owner"?"owner":"student",phone:"",date_of_birth:"",terms_accepted:!1}});n.useEffect(()=>{i&&(i==="student"||i==="owner")&&c.setValue("role",i)},[i,c]);const p=me({mutationFn:t=>_e("POST","/auth/register",t),onSuccess:(t,x)=>{r(`/verify-email?email=${encodeURIComponent(x.email)}`)},onError:t=>{u(t.message||"Registration failed. Please try again.")}}),m=t=>{u(""),p.mutate(t)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-muted/30 p-4",children:e.jsxs("div",{className:"w-full max-w-2xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(T,{href:"/",children:e.jsx("div",{className:"mb-4 cursor-pointer",children:e.jsx(ge,{iconClassName:"h-8 w-8",textClassName:"text-2xl"})})}),e.jsx("h1",{className:"text-3xl font-bold","data-testid":"text-register-title",children:"Create Your Account"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Join thousands of students and landlords on Hoomy"})]}),e.jsxs(ye,{children:[e.jsxs(ke,{children:[e.jsx(Ne,{children:"Sign Up"}),e.jsx(Re,{children:"Fill in your details to create your account"})]}),e.jsxs(we,{children:[l&&e.jsxs(Le,{variant:"destructive",className:"mb-4",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx(Ge,{children:l})]}),e.jsx(xe,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(m),className:"space-y-4",children:[e.jsx(g,{control:c.control,name:"role",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"I am a"}),e.jsx(k,{children:e.jsxs(ae,{onValueChange:t.onChange,value:t.value,className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{value:"student",id:"student","data-testid":"radio-student"}),e.jsx("label",{htmlFor:"student",className:"cursor-pointer",children:"Student looking for housing"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{value:"owner",id:"owner","data-testid":"radio-owner"}),e.jsx("label",{htmlFor:"owner",className:"cursor-pointer",children:"Landlord with properties"})]})]})}),e.jsx(N,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(g,{control:c.control,name:"first_name",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"First Name"}),e.jsx(k,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{...t,placeholder:"John",className:"pl-10","data-testid":"input-firstname"})]})}),e.jsx(N,{})]})}),e.jsx(g,{control:c.control,name:"last_name",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"Last Name"}),e.jsx(k,{children:e.jsx(P,{...t,placeholder:"Doe","data-testid":"input-lastname"})}),e.jsx(N,{})]})})]}),e.jsx(g,{control:c.control,name:"email",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"Email"}),e.jsx(k,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{...t,type:"email",placeholder:"your.email@example.com",className:"pl-10","data-testid":"input-email"})]})}),e.jsx(N,{})]})}),e.jsx(g,{control:c.control,name:"password",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"Password"}),e.jsx(k,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{...t,type:"password",placeholder:"••••••••",className:"pl-10","data-testid":"input-password"})]})}),e.jsx(je,{children:"At least 8 characters"}),e.jsx(N,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(g,{control:c.control,name:"phone",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"Phone (Optional)"}),e.jsx(k,{children:e.jsxs("div",{className:"relative",children:[e.jsx(qe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{...t,placeholder:"+41 76 123 45 67",className:"pl-10","data-testid":"input-phone"})]})}),e.jsx(N,{})]})}),e.jsx(g,{control:c.control,name:"date_of_birth",render:({field:t})=>e.jsxs(C,{children:[e.jsx(y,{children:"Date of Birth"}),e.jsx(k,{children:e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{...t,type:"date",className:"pl-10","data-testid":"input-dob"})]})}),e.jsx(N,{})]})})]}),e.jsx(g,{control:c.control,name:"terms_accepted",render:({field:t})=>e.jsxs(C,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(k,{children:e.jsx(le,{checked:t.value,onCheckedChange:t.onChange,"data-testid":"checkbox-terms"})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(y,{children:["I accept the"," ",e.jsx("a",{href:"/cgu",className:"text-primary hover:underline",onClick:f,children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:"/privacy",className:"text-primary hover:underline",onClick:h,children:"Privacy Policy"})]}),e.jsx(N,{})]})]})}),e.jsx(Ce,{type:"submit",className:"w-full",size:"lg",disabled:p.isPending,"data-testid":"button-submit",children:p.isPending?"Creating account...":"Create Account"})]})}),e.jsx("div",{className:"mt-6 text-center text-sm",children:e.jsxs("p",{className:"text-muted-foreground",children:["Already have an account?"," ",e.jsx(T,{href:"/login",className:"text-primary font-medium hover:underline","data-testid":"link-login",children:"Sign in"})]})})]})]})]})})}export{yt as default};
