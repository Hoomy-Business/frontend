import{h as Q,B as E,X as He,n as ee,g as X,R as ue,c as L,C as fe,d as ve,e as ge,f as xe,b as Me,k as nt,l as it}from"./index-42cH5BrD.js";import{j as t,u as at,b as ot}from"./query-vendor-yCE0qXS-.js";import{h as st,r as m}from"./react-vendor-CvpuY9Ms.js";import{_ as ct,Q as A}from"./ui-vendor-3oCJfrha.js";import{D as te,b as re,c as ne,d as ie,e as ae,f as he}from"./dialog-BnpweDKq.js";import{S as ke}from"./slider-D57ejDrc.js";import{C as lt}from"./user--iiFN26U.js";import{I as Z}from"./input-BQfOhgGT.js";import{L as B}from"./label-67qstHpt.js";import{A as V,a as I}from"./alert-DAdm-3vK.js";import{P as qe}from"./phone-B7UcHeEW.js";import{C as Y}from"./circle-check-Cikh5ACT.js";import{L as F}from"./loader-circle-MquGnOeK.js";import{M as Ye}from"./mail-Bvu9ZxEU.js";import{B as K}from"./badge-7FXoCMHb.js";import{n as we}from"./MainLayout-BNeTwvB_.js";import{C as Ae}from"./tabs-DumrchZ7.js";import{U as ye}from"./upload-qSSxL3Iv.js";const Te=Q("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);const er=Q("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);const Le=Q("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);const dt=Q("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);const ut=Q("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);var Fe=!1,U,je,Ce,ce,le,Ge,de,be,Ne,Ee,Ke,_e,Se,Je,Qe;function T(){if(!Fe){Fe=!0;var o=navigator.userAgent,i=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(o),e=/(Mac OS X)|(Windows)|(Linux)/.exec(o);if(_e=/\b(iPhone|iP[ao]d)/.exec(o),Se=/\b(iP[ao]d)/.exec(o),Ee=/Android/i.exec(o),Je=/FBAN\/\w+;/i.exec(o),Qe=/Mobile/i.exec(o),Ke=!!/Win64/.exec(o),i){U=i[1]?parseFloat(i[1]):i[5]?parseFloat(i[5]):NaN,U&&document&&document.documentMode&&(U=document.documentMode);var r=/(?:Trident\/(\d+.\d+))/.exec(o);Ge=r?parseFloat(r[1])+4:U,je=i[2]?parseFloat(i[2]):NaN,Ce=i[3]?parseFloat(i[3]):NaN,ce=i[4]?parseFloat(i[4]):NaN,ce?(i=/(?:Chrome\/(\d+\.\d+))/.exec(o),le=i&&i[1]?parseFloat(i[1]):NaN):le=NaN}else U=je=Ce=le=ce=NaN;if(e){if(e[1]){var n=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(o);de=n?parseFloat(n[1].replace("_",".")):!0}else de=!1;be=!!e[2],Ne=!!e[3]}else de=be=Ne=!1}}var Re={ie:function(){return T()||U},ieCompatibilityMode:function(){return T()||Ge>U},ie64:function(){return Re.ie()&&Ke},firefox:function(){return T()||je},opera:function(){return T()||Ce},webkit:function(){return T()||ce},safari:function(){return Re.webkit()},chrome:function(){return T()||le},windows:function(){return T()||be},osx:function(){return T()||de},linux:function(){return T()||Ne},iphone:function(){return T()||_e},mobile:function(){return T()||_e||Se||Ee||Qe},nativeApp:function(){return T()||Je},android:function(){return T()||Ee},ipad:function(){return T()||Se}},ht=Re,oe=!!(typeof window<"u"&&window.document&&window.document.createElement),mt={canUseDOM:oe,canUseWorkers:typeof Worker<"u",canUseEventListeners:oe&&!!(window.addEventListener||window.attachEvent),canUseViewport:oe&&!!window.screen,isInWorker:!oe},pt=mt,et=pt,tt;et.canUseDOM&&(tt=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function ft(o,i){if(!et.canUseDOM||i&&!("addEventListener"in document))return!1;var e="on"+o,r=e in document;if(!r){var n=document.createElement("div");n.setAttribute(e,"return;"),r=typeof n[e]=="function"}return!r&&tt&&o==="wheel"&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r}var vt=ft,gt=ht,xt=vt,Ve=10,Ie=40,Oe=800;function rt(o){var i=0,e=0,r=0,n=0;return"detail"in o&&(e=o.detail),"wheelDelta"in o&&(e=-o.wheelDelta/120),"wheelDeltaY"in o&&(e=-o.wheelDeltaY/120),"wheelDeltaX"in o&&(i=-o.wheelDeltaX/120),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(i=e,e=0),r=i*Ve,n=e*Ve,"deltaY"in o&&(n=o.deltaY),"deltaX"in o&&(r=o.deltaX),(r||n)&&o.deltaMode&&(o.deltaMode==1?(r*=Ie,n*=Ie):(r*=Oe,n*=Oe)),r&&!i&&(i=r<1?-1:1),n&&!e&&(e=n<1?-1:1),{spinX:i,spinY:e,pixelX:r,pixelY:n}}rt.getEventType=function(){return gt.firefox()?"DOMMouseScroll":xt("wheel")?"wheel":"mousewheel"};var wt=rt,yt=wt;const jt=st(yt);function Ct(o,i,e,r,n,a){a===void 0&&(a=0);var s=G(o,i,a),c=s.width,h=s.height,p=Math.min(c,e),u=Math.min(h,r);return p>u*n?{width:u*n,height:u}:{width:p,height:p/n}}function bt(o){return o.width>o.height?o.width/o.naturalWidth:o.height/o.naturalHeight}function J(o,i,e,r,n){n===void 0&&(n=0);var a=G(i.width,i.height,n),s=a.width,c=a.height;return{x:Xe(o.x,s,e.width,r),y:Xe(o.y,c,e.height,r)}}function Xe(o,i,e,r){var n=i*r/2-e/2;return me(o,-n,n)}function We(o,i){return Math.sqrt(Math.pow(o.y-i.y,2)+Math.pow(o.x-i.x,2))}function Ue(o,i){return Math.atan2(i.y-o.y,i.x-o.x)*180/Math.PI}function Nt(o,i,e,r,n,a,s){a===void 0&&(a=0),s===void 0&&(s=!0);var c=s?Et:_t,h=G(i.width,i.height,a),p=G(i.naturalWidth,i.naturalHeight,a),u={x:c(100,((h.width-e.width/n)/2-o.x/n)/h.width*100),y:c(100,((h.height-e.height/n)/2-o.y/n)/h.height*100),width:c(100,e.width/h.width*100/n),height:c(100,e.height/h.height*100/n)},j=Math.round(c(p.width,u.width*p.width/100)),l=Math.round(c(p.height,u.height*p.height/100)),v=p.width>=p.height*r,x=v?{width:Math.round(l*r),height:l}:{width:j,height:Math.round(j/r)},w=A(A({},x),{x:Math.round(c(p.width-x.width,u.x*p.width/100)),y:Math.round(c(p.height-x.height,u.y*p.height/100))});return{croppedAreaPercentages:u,croppedAreaPixels:w}}function Et(o,i){return Math.min(o,Math.max(0,i))}function _t(o,i){return i}function St(o,i,e,r,n,a){var s=G(i.width,i.height,e),c=me(r.width/s.width*(100/o.width),n,a),h={x:c*s.width/2-r.width/2-s.width*c*(o.x/100),y:c*s.height/2-r.height/2-s.height*c*(o.y/100)};return{crop:h,zoom:c}}function Rt(o,i,e){var r=bt(i);return e.height>e.width?e.height/(o.height*r):e.width/(o.width*r)}function zt(o,i,e,r,n,a){e===void 0&&(e=0);var s=G(i.naturalWidth,i.naturalHeight,e),c=me(Rt(o,i,r),n,a),h=r.height>r.width?r.height/o.height:r.width/o.width,p={x:((s.width-o.width)/2-o.x)*h,y:((s.height-o.height)/2-o.y)*h};return{crop:p,zoom:c}}function Ze(o,i){return{x:(i.x+o.x)/2,y:(i.y+o.y)/2}}function Dt(o){return o*Math.PI/180}function G(o,i,e){var r=Dt(e);return{width:Math.abs(Math.cos(r)*o)+Math.abs(Math.sin(r)*i),height:Math.abs(Math.sin(r)*o)+Math.abs(Math.cos(r)*i)}}function me(o,i,e){return Math.min(Math.max(o,i),e)}function se(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return o.filter(function(e){return typeof e=="string"&&e.length>0}).join(" ").trim()}var Pt=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,Mt=1,kt=3,At=1,Tt=function(o){ct(i,o);function i(){var e=o!==null&&o.apply(this,arguments)||this;return e.cropperRef=m.createRef(),e.imageRef=m.createRef(),e.videoRef=m.createRef(),e.containerPosition={x:0,y:0},e.containerRef=null,e.styleRef=null,e.containerRect=null,e.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},e.dragStartPosition={x:0,y:0},e.dragStartCrop={x:0,y:0},e.gestureZoomStart=0,e.gestureRotationStart=0,e.isTouching=!1,e.lastPinchDistance=0,e.lastPinchRotation=0,e.rafDragTimeout=null,e.rafPinchTimeout=null,e.wheelTimer=null,e.currentDoc=typeof document<"u"?document:null,e.currentWindow=typeof window<"u"?window:null,e.resizeObserver=null,e.previousCropSize=null,e.isInitialized=!1,e.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},e.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!e.containerRef)){var r=!0;e.resizeObserver=new window.ResizeObserver(function(n){if(r){r=!1;return}e.computeSizes()}),e.resizeObserver.observe(e.containerRef)}},e.preventZoomSafari=function(r){return r.preventDefault()},e.cleanEvents=function(){e.currentDoc&&(e.currentDoc.removeEventListener("mousemove",e.onMouseMove),e.currentDoc.removeEventListener("mouseup",e.onDragStopped),e.currentDoc.removeEventListener("touchmove",e.onTouchMove),e.currentDoc.removeEventListener("touchend",e.onDragStopped),e.currentDoc.removeEventListener("gesturechange",e.onGestureChange),e.currentDoc.removeEventListener("gestureend",e.onGestureEnd),e.currentDoc.removeEventListener("scroll",e.onScroll))},e.clearScrollEvent=function(){e.containerRef&&e.containerRef.removeEventListener("wheel",e.onWheel),e.wheelTimer&&clearTimeout(e.wheelTimer)},e.onMediaLoad=function(){var r=e.computeSizes();r&&(e.previousCropSize=r,e.emitCropData(),e.setInitialCrop(r),e.isInitialized=!0),e.props.onMediaLoaded&&e.props.onMediaLoaded(e.mediaSize)},e.setInitialCrop=function(r){if(e.props.initialCroppedAreaPercentages){var n=St(e.props.initialCroppedAreaPercentages,e.mediaSize,e.props.rotation,r,e.props.minZoom,e.props.maxZoom),a=n.crop,s=n.zoom;e.props.onCropChange(a),e.props.onZoomChange&&e.props.onZoomChange(s)}else if(e.props.initialCroppedAreaPixels){var c=zt(e.props.initialCroppedAreaPixels,e.mediaSize,e.props.rotation,r,e.props.minZoom,e.props.maxZoom),a=c.crop,s=c.zoom;e.props.onCropChange(a),e.props.onZoomChange&&e.props.onZoomChange(s)}},e.computeSizes=function(){var r,n,a,s,c,h,p=e.imageRef.current||e.videoRef.current;if(p&&e.containerRef){e.containerRect=e.containerRef.getBoundingClientRect(),e.saveContainerPosition();var u=e.containerRect.width/e.containerRect.height,j=((r=e.imageRef.current)===null||r===void 0?void 0:r.naturalWidth)||((n=e.videoRef.current)===null||n===void 0?void 0:n.videoWidth)||0,l=((a=e.imageRef.current)===null||a===void 0?void 0:a.naturalHeight)||((s=e.videoRef.current)===null||s===void 0?void 0:s.videoHeight)||0,v=p.offsetWidth<j||p.offsetHeight<l,x=j/l,w=void 0;if(v)switch(e.state.mediaObjectFit){default:case"contain":w=u>x?{width:e.containerRect.height*x,height:e.containerRect.height}:{width:e.containerRect.width,height:e.containerRect.width/x};break;case"horizontal-cover":w={width:e.containerRect.width,height:e.containerRect.width/x};break;case"vertical-cover":w={width:e.containerRect.height*x,height:e.containerRect.height};break}else w={width:p.offsetWidth,height:p.offsetHeight};e.mediaSize=A(A({},w),{naturalWidth:j,naturalHeight:l}),e.props.setMediaSize&&e.props.setMediaSize(e.mediaSize);var g=e.props.cropSize?e.props.cropSize:Ct(e.mediaSize.width,e.mediaSize.height,e.containerRect.width,e.containerRect.height,e.props.aspect,e.props.rotation);return(((c=e.state.cropSize)===null||c===void 0?void 0:c.height)!==g.height||((h=e.state.cropSize)===null||h===void 0?void 0:h.width)!==g.width)&&e.props.onCropSizeChange&&e.props.onCropSizeChange(g),e.setState({cropSize:g},e.recomputeCropPosition),e.props.setCropSize&&e.props.setCropSize(g),g}},e.saveContainerPosition=function(){if(e.containerRef){var r=e.containerRef.getBoundingClientRect();e.containerPosition={x:r.left,y:r.top}}},e.onMouseDown=function(r){e.currentDoc&&(r.preventDefault(),e.currentDoc.addEventListener("mousemove",e.onMouseMove),e.currentDoc.addEventListener("mouseup",e.onDragStopped),e.saveContainerPosition(),e.onDragStart(i.getMousePoint(r)))},e.onMouseMove=function(r){return e.onDrag(i.getMousePoint(r))},e.onScroll=function(r){e.currentDoc&&(r.preventDefault(),e.saveContainerPosition())},e.onTouchStart=function(r){e.currentDoc&&(e.isTouching=!0,!(e.props.onTouchRequest&&!e.props.onTouchRequest(r))&&(e.currentDoc.addEventListener("touchmove",e.onTouchMove,{passive:!1}),e.currentDoc.addEventListener("touchend",e.onDragStopped),e.saveContainerPosition(),r.touches.length===2?e.onPinchStart(r):r.touches.length===1&&e.onDragStart(i.getTouchPoint(r.touches[0]))))},e.onTouchMove=function(r){r.preventDefault(),r.touches.length===2?e.onPinchMove(r):r.touches.length===1&&e.onDrag(i.getTouchPoint(r.touches[0]))},e.onGestureStart=function(r){e.currentDoc&&(r.preventDefault(),e.currentDoc.addEventListener("gesturechange",e.onGestureChange),e.currentDoc.addEventListener("gestureend",e.onGestureEnd),e.gestureZoomStart=e.props.zoom,e.gestureRotationStart=e.props.rotation)},e.onGestureChange=function(r){if(r.preventDefault(),!e.isTouching){var n=i.getMousePoint(r),a=e.gestureZoomStart-1+r.scale;if(e.setNewZoom(a,n,{shouldUpdatePosition:!0}),e.props.onRotationChange){var s=e.gestureRotationStart+r.rotation;e.props.onRotationChange(s)}}},e.onGestureEnd=function(r){e.cleanEvents()},e.onDragStart=function(r){var n,a,s=r.x,c=r.y;e.dragStartPosition={x:s,y:c},e.dragStartCrop=A({},e.props.crop),(a=(n=e.props).onInteractionStart)===null||a===void 0||a.call(n)},e.onDrag=function(r){var n=r.x,a=r.y;e.currentWindow&&(e.rafDragTimeout&&e.currentWindow.cancelAnimationFrame(e.rafDragTimeout),e.rafDragTimeout=e.currentWindow.requestAnimationFrame(function(){if(e.state.cropSize&&!(n===void 0||a===void 0)){var s=n-e.dragStartPosition.x,c=a-e.dragStartPosition.y,h={x:e.dragStartCrop.x+s,y:e.dragStartCrop.y+c},p=e.props.restrictPosition?J(h,e.mediaSize,e.state.cropSize,e.props.zoom,e.props.rotation):h;e.props.onCropChange(p)}}))},e.onDragStopped=function(){var r,n;e.isTouching=!1,e.cleanEvents(),e.emitCropData(),(n=(r=e.props).onInteractionEnd)===null||n===void 0||n.call(r)},e.onWheel=function(r){if(e.currentWindow&&!(e.props.onWheelRequest&&!e.props.onWheelRequest(r))){r.preventDefault();var n=i.getMousePoint(r),a=jt(r).pixelY,s=e.props.zoom-a*e.props.zoomSpeed/200;e.setNewZoom(s,n,{shouldUpdatePosition:!0}),e.state.hasWheelJustStarted||e.setState({hasWheelJustStarted:!0},function(){var c,h;return(h=(c=e.props).onInteractionStart)===null||h===void 0?void 0:h.call(c)}),e.wheelTimer&&clearTimeout(e.wheelTimer),e.wheelTimer=e.currentWindow.setTimeout(function(){return e.setState({hasWheelJustStarted:!1},function(){var c,h;return(h=(c=e.props).onInteractionEnd)===null||h===void 0?void 0:h.call(c)})},250)}},e.getPointOnContainer=function(r,n){var a=r.x,s=r.y;if(!e.containerRect)throw new Error("The Cropper is not mounted");return{x:e.containerRect.width/2-(a-n.x),y:e.containerRect.height/2-(s-n.y)}},e.getPointOnMedia=function(r){var n=r.x,a=r.y,s=e.props,c=s.crop,h=s.zoom;return{x:(n+c.x)/h,y:(a+c.y)/h}},e.setNewZoom=function(r,n,a){var s=a===void 0?{}:a,c=s.shouldUpdatePosition,h=c===void 0?!0:c;if(!(!e.state.cropSize||!e.props.onZoomChange)){var p=me(r,e.props.minZoom,e.props.maxZoom);if(h){var u=e.getPointOnContainer(n,e.containerPosition),j=e.getPointOnMedia(u),l={x:j.x*p-u.x,y:j.y*p-u.y},v=e.props.restrictPosition?J(l,e.mediaSize,e.state.cropSize,p,e.props.rotation):l;e.props.onCropChange(v)}e.props.onZoomChange(p)}},e.getCropData=function(){if(!e.state.cropSize)return null;var r=e.props.restrictPosition?J(e.props.crop,e.mediaSize,e.state.cropSize,e.props.zoom,e.props.rotation):e.props.crop;return Nt(r,e.mediaSize,e.state.cropSize,e.getAspect(),e.props.zoom,e.props.rotation,e.props.restrictPosition)},e.emitCropData=function(){var r=e.getCropData();if(r){var n=r.croppedAreaPercentages,a=r.croppedAreaPixels;e.props.onCropComplete&&e.props.onCropComplete(n,a),e.props.onCropAreaChange&&e.props.onCropAreaChange(n,a)}},e.emitCropAreaChange=function(){var r=e.getCropData();if(r){var n=r.croppedAreaPercentages,a=r.croppedAreaPixels;e.props.onCropAreaChange&&e.props.onCropAreaChange(n,a)}},e.recomputeCropPosition=function(){if(e.state.cropSize){var r=e.props.crop;if(e.isInitialized&&e.previousCropSize){var n=Math.abs(e.previousCropSize.width-e.state.cropSize.width)>1e-6||Math.abs(e.previousCropSize.height-e.state.cropSize.height)>1e-6;if(n){var a=e.state.cropSize.width/e.previousCropSize.width,s=e.state.cropSize.height/e.previousCropSize.height;r={x:e.props.crop.x*a,y:e.props.crop.y*s}}}var c=e.props.restrictPosition?J(r,e.mediaSize,e.state.cropSize,e.props.zoom,e.props.rotation):r;e.previousCropSize=e.state.cropSize,e.props.onCropChange(c),e.emitCropData()}},e.onKeyDown=function(r){var n,a,s=e.props,c=s.crop,h=s.onCropChange,p=s.keyboardStep,u=s.zoom,j=s.rotation,l=p;if(e.state.cropSize){r.shiftKey&&(l*=.2);var v=A({},c);switch(r.key){case"ArrowUp":v.y-=l,r.preventDefault();break;case"ArrowDown":v.y+=l,r.preventDefault();break;case"ArrowLeft":v.x-=l,r.preventDefault();break;case"ArrowRight":v.x+=l,r.preventDefault();break;default:return}e.props.restrictPosition&&(v=J(v,e.mediaSize,e.state.cropSize,u,j)),r.repeat||(a=(n=e.props).onInteractionStart)===null||a===void 0||a.call(n),h(v)}},e.onKeyUp=function(r){var n,a;switch(r.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":r.preventDefault();break;default:return}e.emitCropData(),(a=(n=e.props).onInteractionEnd)===null||a===void 0||a.call(n)},e}return i.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=Pt,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},i.prototype.componentWillUnmount=function(){var e,r;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((r=this.styleRef.parentNode)===null||r===void 0||r.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},i.prototype.componentDidUpdate=function(e){var r,n,a,s,c,h,p,u,j;e.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):e.aspect!==this.props.aspect?this.computeSizes():e.objectFit!==this.props.objectFit?this.computeSizes():e.zoom!==this.props.zoom?this.recomputeCropPosition():((r=e.cropSize)===null||r===void 0?void 0:r.height)!==((n=this.props.cropSize)===null||n===void 0?void 0:n.height)||((a=e.cropSize)===null||a===void 0?void 0:a.width)!==((s=this.props.cropSize)===null||s===void 0?void 0:s.width)?this.computeSizes():(((c=e.crop)===null||c===void 0?void 0:c.x)!==((h=this.props.crop)===null||h===void 0?void 0:h.x)||((p=e.crop)===null||p===void 0?void 0:p.y)!==((u=this.props.crop)===null||u===void 0?void 0:u.y))&&this.emitCropAreaChange(),e.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),e.video!==this.props.video&&((j=this.videoRef.current)===null||j===void 0||j.load());var l=this.getObjectFit();l!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:l},this.computeSizes)},i.prototype.getAspect=function(){var e=this.props,r=e.cropSize,n=e.aspect;return r?r.width/r.height:n},i.prototype.getObjectFit=function(){var e,r,n,a;if(this.props.objectFit==="cover"){var s=this.imageRef.current||this.videoRef.current;if(s&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var c=this.containerRect.width/this.containerRect.height,h=((e=this.imageRef.current)===null||e===void 0?void 0:e.naturalWidth)||((r=this.videoRef.current)===null||r===void 0?void 0:r.videoWidth)||0,p=((n=this.imageRef.current)===null||n===void 0?void 0:n.naturalHeight)||((a=this.videoRef.current)===null||a===void 0?void 0:a.videoHeight)||0,u=h/p;return u<c?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},i.prototype.onPinchStart=function(e){var r=i.getTouchPoint(e.touches[0]),n=i.getTouchPoint(e.touches[1]);this.lastPinchDistance=We(r,n),this.lastPinchRotation=Ue(r,n),this.onDragStart(Ze(r,n))},i.prototype.onPinchMove=function(e){var r=this;if(!(!this.currentDoc||!this.currentWindow)){var n=i.getTouchPoint(e.touches[0]),a=i.getTouchPoint(e.touches[1]),s=Ze(n,a);this.onDrag(s),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var c=We(n,a),h=r.props.zoom*(c/r.lastPinchDistance);r.setNewZoom(h,s,{shouldUpdatePosition:!1}),r.lastPinchDistance=c;var p=Ue(n,a),u=r.props.rotation+(p-r.lastPinchRotation);r.props.onRotationChange&&r.props.onRotationChange(u),r.lastPinchRotation=p})}},i.prototype.render=function(){var e=this,r,n=this.props,a=n.image,s=n.video,c=n.mediaProps,h=n.cropperProps,p=n.transform,u=n.crop,j=u.x,l=u.y,v=n.rotation,x=n.zoom,w=n.cropShape,g=n.showGrid,D=n.roundCropAreaPixels,M=n.style,z=M.containerStyle,k=M.cropAreaStyle,b=M.mediaStyle,S=n.classes,N=S.containerClassName,d=S.cropAreaClassName,y=S.mediaClassName,R=(r=this.state.mediaObjectFit)!==null&&r!==void 0?r:this.getObjectFit();return m.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(C){return e.containerRef=C},"data-testid":"container",style:z,className:se("reactEasyCrop_Container",N)},a?m.createElement("img",A({alt:"",className:se("reactEasyCrop_Image",R==="contain"&&"reactEasyCrop_Contain",R==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",R==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",y)},c,{src:a,ref:this.imageRef,style:A(A({},b),{transform:p||"translate(".concat(j,"px, ").concat(l,"px) rotate(").concat(v,"deg) scale(").concat(x,")")}),onLoad:this.onMediaLoad})):s&&m.createElement("video",A({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:se("reactEasyCrop_Video",R==="contain"&&"reactEasyCrop_Contain",R==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",R==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",y)},c,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:A(A({},b),{transform:p||"translate(".concat(j,"px, ").concat(l,"px) rotate(").concat(v,"deg) scale(").concat(x,")")}),controls:!1}),(Array.isArray(s)?s:[{src:s}]).map(function(P){return m.createElement("source",A({key:P.src},P))})),this.state.cropSize&&m.createElement("div",A({ref:this.cropperRef,style:A(A({},k),{width:D?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:D?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:se("reactEasyCrop_CropArea",w==="round"&&"reactEasyCrop_CropAreaRound",g&&"reactEasyCrop_CropAreaGrid",d)},h)))},i.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:kt,minZoom:Mt,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:At},i.getMousePoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},i.getTouchPoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},i}(m.Component);function tr({open:o,onClose:i,imageSrc:e,onCropComplete:r,aspectRatio:n=1,circularCrop:a=!0}){const[s,c]=m.useState({x:0,y:0}),[h,p]=m.useState(1),[u,j]=m.useState(0),[l,v]=m.useState(null),x=m.useCallback(d=>{c(d)},[]),w=m.useCallback(d=>{p(d)},[]),g=m.useCallback(d=>{j(d)},[]),D=m.useCallback((d,y)=>{v(y)},[]),M=d=>new Promise((y,R)=>{const P=new Image;P.addEventListener("load",()=>y(P)),P.addEventListener("error",C=>R(C)),P.src=d}),z=d=>d*Math.PI/180,k=(d,y,R)=>{const P=z(R);return{width:Math.abs(Math.cos(P)*d)+Math.abs(Math.sin(P)*y),height:Math.abs(Math.sin(P)*d)+Math.abs(Math.cos(P)*y)}},b=async(d,y,R=0,P={horizontal:!1,vertical:!1})=>{const C=await M(d),f=document.createElement("canvas"),_=f.getContext("2d");if(!_)throw new Error("No 2d context");const W=z(R),{width:$,height:H}=k(C.width,C.height,R);f.width=$,f.height=H,_.translate($/2,H/2),_.rotate(W),_.scale(P.horizontal?-1:1,P.vertical?-1:1),_.translate(-C.width/2,-C.height/2),_.drawImage(C,0,0);const pe=_.getImageData(y.x,y.y,y.width,y.height);if(f.width=y.width,f.height=y.height,_.putImageData(pe,0,0),a){const q=document.createElement("canvas");q.width=y.width,q.height=y.height;const O=q.getContext("2d");if(O)return O.beginPath(),O.arc(y.width/2,y.height/2,Math.min(y.width,y.height)/2,0,2*Math.PI),O.clip(),O.drawImage(f,0,0),new Promise(ze=>{q.toBlob(De=>{De?ze(De):f.toBlob(Pe=>{if(Pe)ze(Pe);else throw new Error("Failed to create blob")},"image/png")},"image/png")})}return new Promise(q=>{f.toBlob(O=>{if(O)q(O);else throw new Error("Failed to create blob")},"image/png")})},S=async()=>{if(l)try{const d=await b(e,l,u);r(d),i()}catch(d){console.error("Error cropping image:",d)}},N=()=>{c({x:0,y:0}),p(1),j(0)};return t.jsx(te,{open:o,onOpenChange:i,children:t.jsxs(re,{className:"max-w-2xl w-full p-0",children:[t.jsxs(ne,{className:"px-6 pt-6",children:[t.jsx(ie,{children:"Recadrer votre photo de profil"}),t.jsx(ae,{children:'Ajustez la position, le zoom et la rotation de votre photo, puis cliquez sur "Valider"'})]}),t.jsx("div",{className:"relative w-full h-[400px] bg-black/5 dark:bg-black/20",children:t.jsx(Tt,{image:e,crop:s,zoom:h,rotation:u,aspect:n,onCropChange:x,onZoomChange:w,onRotationChange:g,onCropComplete:D,cropShape:a?"round":"rect",showGrid:!1,style:{containerStyle:{width:"100%",height:"100%",position:"relative"}}})}),t.jsxs("div",{className:"px-6 pb-6 space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ut,{className:"h-4 w-4 text-muted-foreground"}),t.jsx(ke,{value:[h],min:1,max:3,step:.1,onValueChange:d=>w(d[0]),className:"flex-1"}),t.jsx(dt,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Zoom"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Le,{className:"h-4 w-4 text-muted-foreground"}),t.jsx(ke,{value:[u],min:0,max:360,step:1,onValueChange:d=>g(d[0]),className:"flex-1"}),t.jsx(Le,{className:"h-4 w-4 text-muted-foreground rotate-180"})]}),t.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Rotation: ",Math.round(u),"°"]})]}),t.jsxs("div",{className:"flex gap-2 justify-end",children:[t.jsx(E,{variant:"outline",onClick:N,children:"Réinitialiser"}),t.jsxs(E,{variant:"outline",onClick:i,children:[t.jsx(He,{className:"h-4 w-4 mr-2"}),"Annuler"]}),t.jsxs(E,{onClick:S,disabled:!l,children:[t.jsx(lt,{className:"h-4 w-4 mr-2"}),"Valider"]})]})]})]})})}function rr({open:o,onClose:i,onSuccess:e,currentPhone:r}){const{toast:n}=ee(),[a,s]=m.useState("phone_input"),[c,h]=m.useState(""),[p,u]=m.useState(""),[j,l]=m.useState(null),[v,x]=m.useState(!1),[w,g]=m.useState(0),[D,M]=m.useState(null);m.useEffect(()=>{o&&(s("phone_input"),h(r||""),u(""),l(null),g(0))},[o,r]),m.useEffect(()=>{if(w>0){const N=setTimeout(()=>g(w-1),1e3);return()=>clearTimeout(N)}},[w]);const z=async()=>{l(null),x(!0);try{const N=await L("POST","/auth/phone/request-verification",{phone:c});M(N.phone_masked),s("code_verification"),g(60),n({title:"Code envoyé",description:`Un code de vérification a été envoyé au ${N.phone_masked}`})}catch(N){const d=N instanceof Error?N.message:"Erreur lors de l'envoi du code";l(d)}finally{x(!1)}},k=async()=>{l(null),x(!0);try{await L("POST","/auth/phone/verify",{code:p}),s("success"),n({title:"Succès",description:"Votre numéro de téléphone a été vérifié"}),setTimeout(()=>{i(),e==null||e()},1500)}catch(N){if(N.code==="CODE_EXPIRED")l("Le code a expiré. Veuillez demander un nouveau code.");else{const d=N instanceof Error?N.message:"Code incorrect";l(d)}}finally{x(!1)}},b=async()=>{if(!(w>0)){l(null),x(!0);try{await L("POST","/auth/phone/resend-code",{}),g(60),u(""),n({title:"Code renvoyé",description:"Un nouveau code a été envoyé"})}catch(N){const d=N instanceof Error?N.message:"Erreur lors du renvoi du code";l(d)}finally{x(!1)}}},S=()=>{a==="code_verification"?confirm("Voulez-vous annuler la vérification en cours? Vous devrez recommencer.")&&i():i()};return t.jsx(te,{open:o,onOpenChange:S,children:t.jsxs(re,{className:"sm:max-w-md",children:[t.jsxs(ne,{children:[t.jsxs(ie,{className:"flex items-center gap-2",children:[t.jsx(qe,{className:"h-5 w-5"}),a==="success"?"Téléphone vérifié":"Vérifier votre téléphone"]}),t.jsxs(ae,{children:[a==="phone_input"&&"Entrez votre numéro de téléphone suisse pour recevoir un code de vérification par SMS.",a==="code_verification"&&`Entrez le code à 6 chiffres envoyé au ${D||"votre téléphone"}.`,a==="success"&&"Votre numéro de téléphone a été vérifié avec succès!"]})]}),j&&t.jsxs(V,{variant:"destructive",children:[t.jsx(X,{className:"h-4 w-4"}),t.jsx(I,{children:j})]}),a==="phone_input"&&t.jsx("div",{className:"space-y-4 py-4",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx(B,{htmlFor:"phone",children:"Numéro de téléphone"}),t.jsx(Z,{id:"phone",type:"tel",placeholder:"+41 76 123 45 67",value:c,onChange:N=>h(N.target.value),className:"text-lg",disabled:v}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: +41 XX XXX XX XX ou 0XX XXX XX XX"})]})}),a==="code_verification"&&t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(B,{htmlFor:"code",children:"Code de vérification"}),t.jsx(Z,{id:"code",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,placeholder:"123456",value:p,onChange:N=>u(N.target.value.replace(/[^0-9]/g,"")),className:"text-center text-2xl tracking-widest font-mono",disabled:v,autoFocus:!0}),t.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Le code expire dans 15 minutes"})]}),t.jsx("div",{className:"flex justify-center",children:t.jsxs(E,{variant:"ghost",size:"sm",onClick:b,disabled:w>0||v,className:"text-sm",children:[t.jsx(ue,{className:`h-4 w-4 mr-2 ${v?"animate-spin":""}`}),w>0?`Renvoyer dans ${w}s`:"Renvoyer le code"]})})]}),a==="success"&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[t.jsx("div",{className:"rounded-full bg-green-100 p-4 mb-4",children:t.jsx(Y,{className:"h-12 w-12 text-green-600"})}),t.jsx("p",{className:"text-lg font-medium text-green-600",children:"Numéro vérifié!"})]}),t.jsxs(he,{children:[a==="phone_input"&&t.jsxs(t.Fragment,{children:[t.jsx(E,{variant:"outline",onClick:S,children:"Annuler"}),t.jsxs(E,{onClick:z,disabled:!c.trim()||v,children:[v&&t.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}),"Envoyer le code"]})]}),a==="code_verification"&&t.jsxs(t.Fragment,{children:[t.jsx(E,{variant:"outline",onClick:()=>{s("phone_input"),u(""),l(null)},children:"Changer de numéro"}),t.jsxs(E,{onClick:k,disabled:p.length!==6||v,children:[v&&t.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}),"Vérifier"]})]})]})]})})}function nr({open:o,onClose:i,onSuccess:e,currentEmail:r}){const{toast:n}=ee(),[a,s]=m.useState("code_verification"),[c,h]=m.useState(""),[p,u]=m.useState(null),[j,l]=m.useState(!1),[v,x]=m.useState(0),[w,g]=m.useState(null),D=m.useCallback(async()=>{u(null),l(!0);try{const b=await L("POST","/auth/email/send-verification",{});g(b.email_masked||r||"votre email"),x(60),n({title:"Code envoyé",description:`Un code de vérification a été envoyé à ${b.email_masked||r}`})}catch(b){let S="Erreur lors de l'envoi du code";b instanceof Error?S=b.message:b.code==="EMAIL_SERVICE_UNAVAILABLE"&&(S="Le service d'envoi d'email est temporairement indisponible. Veuillez contacter le support ou réessayer plus tard.",b.debug_code),u(S),n({title:"Erreur",description:S,variant:"destructive"})}finally{l(!1)}},[r,n]);m.useEffect(()=>{o&&(s("code_verification"),h(""),u(null),x(0),D())},[o,D]),m.useEffect(()=>{if(v>0){const b=setTimeout(()=>x(v-1),1e3);return()=>clearTimeout(b)}},[v]);const M=async()=>{u(null),l(!0);try{await L("POST","/auth/email/verify",{code:c}),s("success"),n({title:"Succès",description:"Votre email a été vérifié"}),setTimeout(()=>{i(),e==null||e()},1500)}catch(b){if(b.code==="CODE_EXPIRED")u("Le code a expiré. Veuillez demander un nouveau code.");else{const S=b instanceof Error?b.message:"Code incorrect";u(S)}}finally{l(!1)}},z=async()=>{if(!(v>0)){u(null),l(!0);try{await L("POST","/auth/email/send-verification",{}),x(60),h(""),n({title:"Code renvoyé",description:"Un nouveau code a été envoyé"})}catch(b){const S=b instanceof Error?b.message:"Erreur lors du renvoi du code";u(S)}finally{l(!1)}}},k=()=>{a==="code_verification"?confirm("Voulez-vous annuler la vérification en cours?")&&i():i()};return t.jsx(te,{open:o,onOpenChange:k,children:t.jsxs(re,{className:"sm:max-w-md",children:[t.jsxs(ne,{children:[t.jsxs(ie,{className:"flex items-center gap-2",children:[t.jsx(Ye,{className:"h-5 w-5"}),a==="success"?"Email vérifié":"Vérifier votre email"]}),t.jsxs(ae,{children:[a==="code_verification"&&`Entrez le code à 6 chiffres envoyé à ${w||r||"votre email"}.`,a==="success"&&"Votre email a été vérifié avec succès!"]})]}),p&&t.jsxs(V,{variant:"destructive",children:[t.jsx(X,{className:"h-4 w-4"}),t.jsx(I,{children:p})]}),a==="code_verification"&&t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(B,{htmlFor:"code",children:"Code de vérification"}),t.jsx(Z,{id:"code",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,placeholder:"123456",value:c,onChange:b=>h(b.target.value.replace(/[^0-9]/g,"")),className:"text-center text-2xl tracking-widest font-mono",disabled:j,autoFocus:!0}),t.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Le code expire dans 15 minutes"})]}),t.jsx("div",{className:"flex justify-center",children:t.jsxs(E,{variant:"ghost",size:"sm",onClick:z,disabled:v>0||j,className:"text-sm",children:[t.jsx(ue,{className:`h-4 w-4 mr-2 ${j?"animate-spin":""}`}),v>0?`Renvoyer dans ${v}s`:"Renvoyer le code"]})})]}),a==="success"&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[t.jsx("div",{className:"rounded-full bg-green-100 p-4 mb-4",children:t.jsx(Y,{className:"h-12 w-12 text-green-600"})}),t.jsx("p",{className:"text-lg font-medium text-green-600",children:"Email vérifié!"})]}),t.jsx(he,{children:a==="code_verification"&&t.jsxs(t.Fragment,{children:[t.jsx(E,{variant:"outline",onClick:k,children:"Annuler"}),t.jsxs(E,{onClick:M,disabled:c.length!==6||j,children:[j&&t.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}),"Vérifier"]})]})})]})})}const Be=o=>{const i=o.split("@");if(i.length!==2)return o;const[e,r]=i;return!e||e.length<=2?o:`${e[0]+"***"+e[e.length-1]}@${r}`};function ir({open:o,onClose:i,onSuccess:e,currentEmail:r}){const{toast:n}=ee(),[a,s]=m.useState("verify_old_email"),[c,h]=m.useState(""),[p,u]=m.useState(""),[j,l]=m.useState(null),[v,x]=m.useState(!1),[w,g]=m.useState(0),[D,M]=m.useState(null),z=m.useCallback(async()=>{l(null),x(!0);try{await L("POST","/auth/email/request-change",{}),M(r?Be(r):"votre email"),g(60),n({title:"Code envoyé",description:`Un code de confirmation a été envoyé à ${D||r}`})}catch(d){let y="Erreur lors de l'envoi du code";d instanceof Error?y=d.message:d.code==="EMAIL_SERVICE_UNAVAILABLE"&&(y="Le service d'envoi d'email est temporairement indisponible. Veuillez contacter le support ou réessayer plus tard.",d.debug_code),l(y),n({title:"Erreur",description:y,variant:"destructive"})}finally{x(!1)}},[r,n]);m.useEffect(()=>{o&&(s("verify_old_email"),h(""),u(""),l(null),g(0),M(r?Be(r):null),z())},[o,r,z]),m.useEffect(()=>{if(w>0){const d=setTimeout(()=>g(w-1),1e3);return()=>clearTimeout(d)}},[w]);const k=async()=>{l(null),x(!0);try{await L("POST","/auth/email/verify-change-code",{code:c}),s("new_email"),l(null)}catch(d){if(d.code==="CODE_EXPIRED")l("Le code a expiré. Veuillez demander un nouveau code.");else{const y=d instanceof Error?d.message:"Code incorrect";l(y)}}finally{x(!1)}},b=async()=>{l(null),x(!0);try{await L("PUT","/auth/profile",{email:p,email_change_code:c}),s("success"),n({title:"Succès",description:"Votre email a été modifié. Un code de vérification a été envoyé au nouvel email."}),setTimeout(()=>{i(),e==null||e()},2e3)}catch(d){const y=d instanceof Error?d.message:"Erreur lors du changement d'email";l(y)}finally{x(!1)}},S=async()=>{if(!(w>0)){l(null),x(!0);try{a==="verify_old_email"&&await z()}catch(d){const y=d instanceof Error?d.message:"Erreur lors du renvoi du code";l(y)}finally{x(!1)}}},N=()=>{a!=="success"?confirm("Voulez-vous annuler le changement d'email?")&&i():i()};return t.jsx(te,{open:o,onOpenChange:N,children:t.jsxs(re,{className:"sm:max-w-md",children:[t.jsxs(ne,{children:[t.jsxs(ie,{className:"flex items-center gap-2",children:[t.jsx(Ye,{className:"h-5 w-5"}),a==="success"?"Email modifié":"Changer votre email"]}),t.jsxs(ae,{children:[a==="verify_old_email"&&`Pour des raisons de sécurité, nous devons vérifier votre identité. Entrez le code envoyé à ${D||r||"votre email actuel"}.`,a==="new_email"&&"Entrez votre nouveau email. Un code de vérification sera envoyé à cette adresse.",a==="success"&&"Votre email a été modifié avec succès!"]})]}),j&&t.jsxs(V,{variant:"destructive",children:[t.jsx(X,{className:"h-4 w-4"}),t.jsx(I,{children:j})]}),a==="verify_old_email"&&t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(B,{htmlFor:"old_email_code",children:"Code de confirmation"}),t.jsx(Z,{id:"old_email_code",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,placeholder:"123456",value:c,onChange:d=>h(d.target.value.replace(/[^0-9]/g,"")),className:"text-center text-2xl tracking-widest font-mono",disabled:v,autoFocus:!0}),t.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Code envoyé à ",D||r]})]}),t.jsx("div",{className:"flex justify-center",children:t.jsxs(E,{variant:"ghost",size:"sm",onClick:S,disabled:w>0||v,className:"text-sm",children:[t.jsx(ue,{className:`h-4 w-4 mr-2 ${v?"animate-spin":""}`}),w>0?`Renvoyer dans ${w}s`:"Renvoyer le code"]})})]}),a==="new_email"&&t.jsx("div",{className:"space-y-4 py-4",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx(B,{htmlFor:"new_email",children:"Nouvel email"}),t.jsx(Z,{id:"new_email",type:"email",placeholder:"nouveau@email.com",value:p,onChange:d=>u(d.target.value),className:"text-lg",disabled:v,autoFocus:!0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Vous devrez vérifier ce nouvel email après le changement."})]})}),a==="success"&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[t.jsx("div",{className:"rounded-full bg-green-100 p-4 mb-4",children:t.jsx(Y,{className:"h-12 w-12 text-green-600"})}),t.jsx("p",{className:"text-lg font-medium text-green-600",children:"Email modifié!"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"Un code de vérification a été envoyé à votre nouvel email."})]}),t.jsxs(he,{children:[a==="verify_old_email"&&t.jsxs(t.Fragment,{children:[t.jsx(E,{variant:"outline",onClick:N,children:"Annuler"}),t.jsxs(E,{onClick:k,disabled:c.length!==6||v,children:[v&&t.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}),"Vérifier"]})]}),a==="new_email"&&t.jsxs(t.Fragment,{children:[t.jsx(E,{variant:"outline",onClick:()=>{s("verify_old_email"),u(""),l(null)},children:"Retour"}),t.jsxs(E,{onClick:b,disabled:!p.trim()||v,children:[v&&t.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}),"Changer l'email"]})]})]})]})})}const $e=o=>{if(!o||o.length<4)return o;const i=o.replace(/\D/g,"");if(i.length<4)return o;const e=i.slice(-4);return`${i.slice(0,-4).slice(0,2)}***${e}`};function ar({open:o,onClose:i,onSuccess:e,currentPhone:r}){const{toast:n}=ee(),[a,s]=m.useState("verify_old_phone"),[c,h]=m.useState(""),[p,u]=m.useState(""),[j,l]=m.useState(null),[v,x]=m.useState(!1),[w,g]=m.useState(0),[D,M]=m.useState(null),z=m.useCallback(async()=>{l(null),x(!0);try{await L("POST","/auth/phone/request-change",{});const d=r?$e(r):"votre téléphone";M(d),g(60),n({title:"Code envoyé",description:`Un code de confirmation a été envoyé à ${d}`})}catch(d){let y="Erreur lors de l'envoi du code";d instanceof Error?y=d.message:d.code==="SMS_SERVICE_UNAVAILABLE"&&(y="Le service d'envoi de SMS est temporairement indisponible. Veuillez contacter le support ou réessayer plus tard.",d.debug_code),l(y),n({title:"Erreur",description:y,variant:"destructive"})}finally{x(!1)}},[r,n]);m.useEffect(()=>{o&&(s("verify_old_phone"),h(""),u(""),l(null),g(0),M(r?$e(r):null),z())},[o,r,z]),m.useEffect(()=>{if(w>0){const d=setTimeout(()=>g(w-1),1e3);return()=>clearTimeout(d)}},[w]);const k=async()=>{l(null),x(!0);try{await L("POST","/auth/phone/verify-change-code",{code:c}),s("new_phone"),l(null)}catch(d){if(d.code==="CODE_EXPIRED")l("Le code a expiré. Veuillez demander un nouveau code.");else{const y=d instanceof Error?d.message:"Code incorrect";l(y)}}finally{x(!1)}},b=async()=>{l(null),x(!0);try{await L("PUT","/auth/profile",{phone:p,phone_change_code:c}),s("success"),n({title:"Succès",description:"Votre numéro de téléphone a été modifié. Un code de vérification a été envoyé au nouveau numéro."}),setTimeout(()=>{i(),e==null||e()},2e3)}catch(d){const y=d instanceof Error?d.message:"Erreur lors du changement de numéro";l(y)}finally{x(!1)}},S=async()=>{if(!(w>0)){l(null),x(!0);try{a==="verify_old_phone"&&await z()}catch(d){const y=d instanceof Error?d.message:"Erreur lors du renvoi du code";l(y)}finally{x(!1)}}},N=()=>{a!=="success"?confirm("Voulez-vous annuler le changement de numéro?")&&i():i()};return t.jsx(te,{open:o,onOpenChange:N,children:t.jsxs(re,{className:"sm:max-w-md",children:[t.jsxs(ne,{children:[t.jsxs(ie,{className:"flex items-center gap-2",children:[t.jsx(qe,{className:"h-5 w-5"}),a==="success"?"Numéro modifié":"Changer votre numéro de téléphone"]}),t.jsxs(ae,{children:[a==="verify_old_phone"&&`Pour des raisons de sécurité, nous devons vérifier votre identité. Entrez le code envoyé à ${D||r||"votre téléphone actuel"}.`,a==="new_phone"&&"Entrez votre nouveau numéro de téléphone. Un code de vérification sera envoyé à ce numéro.",a==="success"&&"Votre numéro de téléphone a été modifié avec succès!"]})]}),j&&t.jsxs(V,{variant:"destructive",children:[t.jsx(X,{className:"h-4 w-4"}),t.jsx(I,{children:j})]}),a==="verify_old_phone"&&t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(B,{htmlFor:"old_phone_code",children:"Code de confirmation"}),t.jsx(Z,{id:"old_phone_code",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,placeholder:"123456",value:c,onChange:d=>h(d.target.value.replace(/[^0-9]/g,"")),className:"text-center text-2xl tracking-widest font-mono",disabled:v,autoFocus:!0}),t.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Code envoyé à ",D||r]})]}),t.jsx("div",{className:"flex justify-center",children:t.jsxs(E,{variant:"ghost",size:"sm",onClick:S,disabled:w>0||v,className:"text-sm",children:[t.jsx(ue,{className:`h-4 w-4 mr-2 ${v?"animate-spin":""}`}),w>0?`Renvoyer dans ${w}s`:"Renvoyer le code"]})})]}),a==="new_phone"&&t.jsx("div",{className:"space-y-4 py-4",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx(B,{htmlFor:"new_phone",children:"Nouveau numéro de téléphone"}),t.jsx(Z,{id:"new_phone",type:"tel",placeholder:"+41 76 123 45 67",value:p,onChange:d=>u(d.target.value),className:"text-lg",disabled:v,autoFocus:!0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: +41 XX XXX XX XX ou 0XX XXX XX XX. Vous devrez vérifier ce nouveau numéro après le changement."})]})}),a==="success"&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[t.jsx("div",{className:"rounded-full bg-green-100 p-4 mb-4",children:t.jsx(Y,{className:"h-12 w-12 text-green-600"})}),t.jsx("p",{className:"text-lg font-medium text-green-600",children:"Numéro modifié!"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"Un code de vérification a été envoyé à votre nouveau numéro."})]}),t.jsxs(he,{children:[a==="verify_old_phone"&&t.jsxs(t.Fragment,{children:[t.jsx(E,{variant:"outline",onClick:N,children:"Annuler"}),t.jsxs(E,{onClick:k,disabled:c.length!==6||v,children:[v&&t.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}),"Vérifier"]})]}),a==="new_phone"&&t.jsxs(t.Fragment,{children:[t.jsx(E,{variant:"outline",onClick:()=>{s("verify_old_phone"),u(""),l(null)},children:"Retour"}),t.jsxs(E,{onClick:b,disabled:!p.trim()||v,children:[v&&t.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}),"Changer le numéro"]})]})]})]})})}function or(){const{toast:o}=ee(),[i,e]=m.useState(null),[r,n]=m.useState(null),[a,s]=m.useState(null),[c,h]=m.useState(!1),[p,u]=m.useState(!1),[j,l]=m.useState(null),v=m.useRef(null),x=m.useRef(null),w=m.useRef(null),{data:g,isLoading:D,refetch:M,error:z}=at({queryKey:["/kyc/status"],queryFn:async()=>L("GET","/kyc/status"),retry:1}),k=ot({mutationFn:async C=>{const f=nt();if(!f)throw new Error("Non authentifié");const $=`${it().replace(/\/+$/,"")}/kyc/submit`,H=await fetch($,{method:"POST",headers:{Authorization:`Bearer ${f}`},body:C});if(!H.ok){const pe=await H.json();throw new Error(pe.error||"Erreur lors de la soumission du KYC")}return H.json()},onSuccess:()=>{o({title:"KYC soumis avec succès",description:"Votre demande de vérification a été envoyée. Vous serez notifié une fois la vérification terminée."}),M(),e(null),n(null),s(null)},onError:C=>{o({title:"Erreur",description:C.message,variant:"destructive"})}});m.useEffect(()=>{if(!c){w.current&&(w.current.getTracks().forEach(f=>f.stop()),w.current=null),u(!1),l(null);return}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){const f="Votre navigateur ne supporte pas l'accès à la caméra, ou le site doit être en HTTPS.";l(f),u(!1),o({title:"Caméra non disponible",description:f,variant:"destructive"});return}u(!0),l(null);const C=()=>{if(!v.current){setTimeout(C,100);return}navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}).then(f=>{try{w.current=f,v.current?(v.current.srcObject=f,v.current.onloadedmetadata=()=>{u(!1),v.current&&v.current.play().catch(_=>{l("Erreur lors de la lecture de la vidéo"),u(!1)})}):(f.getTracks().forEach(_=>_.stop()),l("Élément vidéo non disponible"),u(!1))}catch{f.getTracks().forEach(W=>W.stop()),l("Erreur lors de la configuration de la caméra"),u(!1)}}).catch(f=>{let _="Impossible d'accéder à la caméra.";f.name==="NotAllowedError"||f.name==="PermissionDeniedError"?_="Permission d'accès à la caméra refusée. Veuillez autoriser l'accès dans les paramètres de votre navigateur.":f.name==="NotFoundError"||f.name==="DevicesNotFoundError"?_="Aucune caméra trouvée sur cet appareil.":f.name==="NotReadableError"||f.name==="TrackStartError"?_="La caméra est déjà utilisée par une autre application.":f.name==="OverconstrainedError"||f.name==="ConstraintNotSatisfiedError"?_="Les paramètres de la caméra ne sont pas supportés.":f.name==="SecurityError"&&(_="Accès à la caméra bloqué pour des raisons de sécurité. Le site doit être en HTTPS."),l(_),u(!1),o({title:"Erreur caméra",description:_,variant:"destructive"})})};return C(),()=>{w.current&&(w.current.getTracks().forEach(f=>f.stop()),w.current=null),u(!1),l(null)}},[c,o]);const b=()=>{if(v.current&&x.current){const C=v.current,f=x.current;f.width=C.videoWidth,f.height=C.videoHeight;const _=f.getContext("2d");_&&(_.drawImage(C,0,0),f.toBlob(W=>{if(W){const $=new File([W],"selfie.jpg",{type:"image/jpeg"});s($),h(!1)}},"image/jpeg",.9))}},S=(C,f)=>{C==="front"?e(f):n(f)},N=async()=>{if(!i||!r||!a){o({title:"Documents manquants",description:"Veuillez fournir tous les documents requis.",variant:"destructive"});return}const C=new FormData;C.append("id_card_front",i),C.append("id_card_back",r),C.append("selfie",a),k.mutate(C)},d=()=>{if(!g)return t.jsxs(K,{variant:"outline",children:[t.jsx(X,{className:"h-3 w-3 mr-1"}),"Non soumis"]});switch(g.status){case"approved":return t.jsxs(K,{className:"bg-green-500",children:[t.jsx(Y,{className:"h-3 w-3 mr-1"}),"Vérifié"]});case"pending":return t.jsxs(K,{variant:"secondary",children:[t.jsx(F,{className:"h-3 w-3 mr-1 animate-spin"}),"En attente"]});case"rejected":return t.jsxs(K,{variant:"destructive",children:[t.jsx(Ae,{className:"h-3 w-3 mr-1"}),"Rejeté"]});case"not_submitted":default:return t.jsxs(K,{variant:"outline",children:[t.jsx(X,{className:"h-3 w-3 mr-1"}),"Non soumis"]})}};if(D)return t.jsx(fe,{children:t.jsxs(ve,{children:[t.jsx(ge,{children:"Vérification KYC"}),t.jsx(xe,{children:"Chargement..."})]})});if(z)return t.jsxs(fe,{children:[t.jsxs(ve,{children:[t.jsx(ge,{children:"Vérification KYC"}),t.jsx(xe,{children:"Erreur de chargement"})]}),t.jsx(Me,{children:t.jsxs(V,{variant:"destructive",children:[t.jsx(X,{className:"h-4 w-4"}),t.jsxs(I,{children:["Impossible de charger le statut KYC. Veuillez vérifier que le serveur backend est démarré et que la route /api/kyc/status est accessible.",t.jsx("br",{}),t.jsxs("small",{className:"text-xs mt-2 block",children:["Erreur: ",z instanceof Error?z.message:"Erreur inconnue"]})]})]})})]});const y=(g==null?void 0:g.status)==="approved",R=(g==null?void 0:g.status)==="pending",P=(g==null?void 0:g.status)==="rejected";return!g||g.status==="not_submitted"||g.status!=="approved"&&g.status!=="pending"&&g.status,t.jsxs(fe,{children:[t.jsx(ve,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(ge,{children:"Vérification KYC"}),t.jsx(xe,{children:"Vérification d'identité requise pour publier des annonces"})]}),d()]})}),t.jsxs(Me,{className:"space-y-6",children:[y&&t.jsxs(V,{children:[t.jsx(Y,{className:"h-4 w-4"}),t.jsx(I,{children:"Votre identité a été vérifiée avec succès. Vous pouvez maintenant publier des annonces."})]}),R&&t.jsxs(V,{children:[t.jsx(F,{className:"h-4 w-4 animate-spin"}),t.jsx(I,{children:"Votre demande de vérification est en cours d'examen. Vous serez notifié une fois la vérification terminée."})]}),P&&g.rejection_reason&&t.jsxs(V,{variant:"destructive",children:[t.jsx(Ae,{className:"h-4 w-4"}),t.jsxs(I,{children:[t.jsx("strong",{children:"Vérification rejetée:"})," ",g.rejection_reason,t.jsx("br",{}),"Veuillez soumettre à nouveau vos documents."]})]}),!y&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"text-sm font-medium mb-2 block",children:["Carte d'identité - Recto ",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("input",{type:"file",accept:"image/*",onChange:C=>{var f;return S("front",((f=C.target.files)==null?void 0:f[0])||null)},className:"hidden",id:"id-card-front",disabled:R}),t.jsx("label",{htmlFor:"id-card-front",children:t.jsx(E,{variant:"outline",asChild:!0,disabled:R,children:t.jsxs("span",{children:[t.jsx(ye,{className:"h-4 w-4 mr-2"}),i?"Changer":"Télécharger"]})})}),i&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:URL.createObjectURL(i),alt:"Prévisualisation recto",className:"h-20 w-auto rounded border object-cover"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:i.name})]}),(g==null?void 0:g.id_card_front_url)&&!i&&t.jsx("img",{src:we(g.id_card_front_url),alt:"Carte d'identité recto",className:"h-20 w-auto rounded border",onError:C=>{const f=C.currentTarget;f.src.startsWith("http://")&&(f.src=f.src.replace("http://","https://"))}})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"text-sm font-medium mb-2 block",children:["Carte d'identité - Verso ",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("input",{type:"file",accept:"image/*",onChange:C=>{var f;return S("back",((f=C.target.files)==null?void 0:f[0])||null)},className:"hidden",id:"id-card-back",disabled:R}),t.jsx("label",{htmlFor:"id-card-back",children:t.jsx(E,{variant:"outline",asChild:!0,disabled:R,children:t.jsxs("span",{children:[t.jsx(ye,{className:"h-4 w-4 mr-2"}),r?"Changer":"Télécharger"]})})}),r&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:URL.createObjectURL(r),alt:"Prévisualisation verso",className:"h-20 w-auto rounded border object-cover"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:r.name})]}),(g==null?void 0:g.id_card_back_url)&&!r&&t.jsx("img",{src:we(g.id_card_back_url),alt:"Carte d'identité verso",className:"h-20 w-auto rounded border",onError:C=>{const f=C.currentTarget;f.src.startsWith("http://")&&(f.src=f.src.replace("http://","https://"))}})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"text-sm font-medium mb-2 block",children:["Selfie ",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsxs("div",{className:"space-y-4",children:[!c&&!a&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[typeof navigator<"u"&&"mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices&&t.jsxs(E,{variant:"outline",onClick:()=>h(!0),disabled:R,children:[t.jsx(Te,{className:"h-4 w-4 mr-2"}),"Prendre un selfie"]}),t.jsx("input",{type:"file",accept:"image/*",capture:"user",onChange:C=>{var _;const f=(_=C.target.files)==null?void 0:_[0];f&&s(f)},className:"hidden",id:"selfie-upload",disabled:R}),t.jsx("label",{htmlFor:"selfie-upload",children:t.jsx(E,{variant:"outline",asChild:!0,disabled:R,children:t.jsxs("span",{children:[t.jsx(ye,{className:"h-4 w-4 mr-2"}),typeof navigator<"u"&&"mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices?"Ou uploader depuis la galerie":"Uploader une photo"]})})})]}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&t.jsx("p",{className:"text-xs text-muted-foreground",children:"⚠️ La caméra en direct nécessite HTTPS. Vous pouvez uploader une photo depuis votre galerie."})]}),c&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"relative border rounded-lg overflow-hidden bg-black min-h-[300px] flex items-center justify-center",children:[p&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10",children:t.jsxs("div",{className:"text-center text-white",children:[t.jsx(F,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),t.jsx("p",{className:"text-sm",children:"Chargement de la caméra..."})]})}),j&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10 p-4",children:t.jsxs(V,{variant:"destructive",className:"max-w-md",children:[t.jsx(X,{className:"h-4 w-4"}),t.jsx(I,{children:j})]})}),t.jsx("video",{ref:v,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full max-w-md mx-auto",style:{transform:"scaleX(-1)",display:j?"none":"block"}}),t.jsx("canvas",{ref:x,className:"hidden"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(E,{onClick:b,disabled:p||!!j||!w.current,children:[t.jsx(Te,{className:"h-4 w-4 mr-2"}),"Capturer"]}),t.jsx(E,{variant:"outline",onClick:()=>{h(!1),l(null),u(!1)},children:"Annuler"})]})]}),a&&!c&&t.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[t.jsx("img",{src:URL.createObjectURL(a),alt:"Prévisualisation selfie",className:"h-32 w-auto rounded border object-cover"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium",children:a.name}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[(a.size/1024).toFixed(1)," KB"]}),t.jsxs(E,{type:"button",variant:"outline",size:"sm",className:"mt-2",onClick:()=>s(null),disabled:R,children:[t.jsx(He,{className:"h-3 w-3 mr-1"}),"Supprimer"]})]})]}),(g==null?void 0:g.selfie_url)&&!a&&!c&&t.jsx("div",{className:"mt-4",children:t.jsx("img",{src:we(g.selfie_url),alt:"Selfie soumis",className:"h-32 w-auto rounded border",onError:C=>{const f=C.currentTarget;f.src.startsWith("http://")&&!f.dataset.httpsTried&&(f.dataset.httpsTried="true",f.src=f.src.replace("http://","https://"))}})})]})]})]}),t.jsx(E,{onClick:N,disabled:!i||!r||!a||k.isPending||R,className:"w-full",children:k.isPending?t.jsxs(t.Fragment,{children:[t.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}),"Soumission en cours..."]}):"Soumettre la vérification"})]})]})]})}export{Te as C,nr as E,er as I,or as K,rr as P,tr as a,ir as b,ar as c};
