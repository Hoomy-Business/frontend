import{b as N,j as e}from"./query-vendor-yCE0qXS-.js";import{u as v,r as c,L as m}from"./react-vendor-CvpuY9Ms.js";import{u as w,F as E,a as u,b as x,c as h,d as p,e as f,t as C,l as L}from"./schema-O3EbQSGn.js";import{L as y}from"./Logo-Bsxlbf95.js";import{a as F,C as S,d as A,e as I,f as D,b as T,g as M,B as P,c as _}from"./index-42cH5BrD.js";import{I as j}from"./input-BQfOhgGT.js";import{A as k,a as O}from"./alert-DAdm-3vK.js";import{M as V}from"./mail-Bvu9ZxEU.js";import{L as R}from"./lock-BKyBGEpi.js";import"./ui-vendor-3oCJfrha.js";import"./label-67qstHpt.js";function Y(){v();const{login:g,isAuthenticated:l,user:a}=F(),[d,r]=c.useState("");c.useEffect(()=>{if(l&&a){let s="/dashboard/owner";a.role==="admin"?s="/admin/dashboard":a.role==="student"&&(s="/dashboard/student"),window.location.href=s}},[l,a]);const o=w({resolver:C(L),defaultValues:{email:"",password:""}}),i=N({mutationFn:s=>_("POST","/login",s),onSuccess:s=>{g(s.token,s.user);const t=s.user.role;let n="/dashboard/owner";t==="admin"?n="/admin/dashboard":t==="student"&&(n="/dashboard/student"),window.location.href=n},onError:s=>{const t=s.code;t==="EMAIL_NOT_VERIFIED"||s.message.includes("EMAIL_NOT_VERIFIED")?r("Votre adresse email n'est pas encore vérifiée. Consultez votre boîte mail (et les spams) pour trouver le code de vérification."):t==="ACCOUNT_DELETED"||s.message.includes("ACCOUNT_DELETED")?r("Ce compte a été supprimé et n'est plus accessible."):r(s.message||"La connexion a échoué. Vérifiez votre email et mot de passe.")}}),b=s=>{r(""),i.mutate(s)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-muted/30 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(m,{href:"/",children:e.jsx("div",{className:"mb-4 cursor-pointer",children:e.jsx(y,{iconClassName:"h-8 w-8",textClassName:"text-2xl"})})}),e.jsx("h1",{className:"text-3xl font-bold","data-testid":"text-login-title",children:"Welcome Back"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Sign in to your account to continue"})]}),e.jsxs(S,{children:[e.jsxs(A,{children:[e.jsx(I,{children:"Login"}),e.jsx(D,{children:"Enter your email and password to access your account"})]}),e.jsxs(T,{children:[d&&e.jsxs(k,{variant:"destructive",className:"mb-4",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx(O,{children:d})]}),e.jsx(E,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(b),className:"space-y-4",children:[e.jsx(u,{control:o.control,name:"email",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Email"}),e.jsx(p,{children:e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{...s,type:"email",placeholder:"your.email@example.com",className:"pl-10","data-testid":"input-email"})]})}),e.jsx(f,{})]})}),e.jsx(u,{control:o.control,name:"password",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Password"}),e.jsx(p,{children:e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{...s,type:"password",placeholder:"••••••••",className:"pl-10","data-testid":"input-password"})]})}),e.jsx(f,{})]})}),e.jsx(P,{type:"submit",className:"w-full",size:"lg",disabled:i.isPending,"data-testid":"button-submit",children:i.isPending?"Signing in...":"Sign In"})]})}),e.jsx("div",{className:"mt-6 text-center text-sm",children:e.jsxs("p",{className:"text-muted-foreground",children:["Don't have an account?"," ",e.jsx(m,{href:"/register",className:"text-primary font-medium hover:underline","data-testid":"link-register",children:"Sign up"})]})})]})]})]})})}export{Y as default};
